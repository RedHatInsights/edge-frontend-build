(self.webpackChunkedge_frontend=self.webpackChunkedge_frontend||[]).push([[7347],{66581:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>q});var r=n(15861),a=n(29439),l=n(64687),i=n.n(l),o=n(92950),c=n.n(o),s=n(21061),u=n(45697),d=n.n(u),p=n(64029),m=n(32835),v=n(47173),f=n(32203),g=n(62394),h=n(15627),y=n(16488),E=n(32045),b=n(50383),P=n(68340),D=n(68774),w=n(38779),x=n(8027),O=n(98309),k=n(77760),T=n(9192),I=n(62410),S=n(89376),j=n(39173),N=n(96094),Z=n(34766),_=n(68519),U=n(5513),L=n(32349),C=n(48903),A=[{label:"Version",type:"text"},{label:"Release",type:"text"},{label:"Additional packages",type:"text"},{label:"All packages",type:"text"},{label:"Systems running",type:"text"},{label:"Created",type:"text"}],M=[{title:"Version",cellTransforms:[(0,Z.headerCol)("selectable-radio")]},{title:"Release"},{title:"Additional packages"},{title:"All packages"},{title:"Systems running"},{title:"Created"}],R=function(e){var t=e.image,n=[{version:t.cells[0],release:t.cells[1],additionalPackages:t.cells[2],allPackages:t.cells[3],systemsRunning:t.cells[4],created:t.cells[5]}],r="Version",a="Release",l="Additional packages",i="All packages",o="Systems running",s="Created";return c().createElement(c().Fragment,null,c().createElement(D.D,null,c().createElement(w.D,{headingLevel:"h2"},c().createElement(P.x,null,"Current version"))),c().createElement(Z.TableComposable,{"aria-label":"Current version table",variant:"compact",borders:!1},c().createElement(Z.Thead,null,c().createElement(Z.Tr,{style:{borderBottomStyle:"hidden"}},c().createElement(Z.Th,{style:{width:"3%"}}),c().createElement(Z.Th,null,r),c().createElement(Z.Th,null,a),c().createElement(Z.Th,null,l),c().createElement(Z.Th,null,i),c().createElement(Z.Th,null,o),c().createElement(Z.Th,null,s))),c().createElement(Z.Tbody,null,n.map((function(e,t){return c().createElement(Z.Tr,{key:t},c().createElement(Z.Td,null),c().createElement(Z.Td,{dataLabel:r},e.version),c().createElement(Z.Td,{dataLabel:a},e.release),c().createElement(Z.Td,{dataLabel:l},e.additionalPackages),c().createElement(Z.Td,{dataLabel:i},e.allPackages),c().createElement(Z.Td,{dataLabel:o},e.systemsRunning),c().createElement(Z.Td,{dataLabel:s},e.created))})))))};R.propTypes={image:d().object};var W=function(e){var t,n,l,u,d=e.data,p=e.fetchDevices,m=e.isLoading,b=e.hasError,S=e.historyProp,j=e.navigateProp,N=e.locationProp,Z=e.currentId,C=e.notificationProp,W=null==d?void 0:d.Device,F=(0,o.useState)(null),q=(0,a.Z)(F,2),V=q[0],B=q[1],X=(0,o.useState)(null),z=(0,a.Z)(X,2),G=z[0],H=z[1],Q=(0,o.useState)(!1),J=(0,a.Z)(Q,2),K=J[0],Y=J[1],$=(0,k.useDispatch)(),ee=S?S():_.k6?(0,_.k6)():null,te=j?j():U.useNavigate?(0,U.useNavigate)():null,ne=N?N():(0,_.TH)(),re=ne.pathname,ae=ne.search,le=function(){var e=(0,r.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Y(!0),t={onInfo:{title:"Updating system",description:" ".concat(G.deviceName," was added to the queue.")},onError:{title:"Error",description:"Failed to update the selected system(s)"}},e.next=4,(0,L.Z)($,(function(){return(0,x.EQ)({CommitID:G.commitID,DevicesUUID:[G.deviceUUID]})}),t,C);case 4:ie(),Y(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=T._.inventory,t=(0,_.LX)(re,{path:T._.inventoryDetailUpdate,exact:!0,strict:!1}),n=(0,_.LX)(re,{path:T._.insightsInventoryDetailUpdate,exact:!0,strict:!1}),r=(0,_.LX)("/inventory/".concat(Z),{path:T._.inventoryDetail,exact:!0,strict:!1});if(re===(null==t?void 0:t.url)&&(e=ae.includes("from_details=true")?r.url:T._.inventory),re===(null==n?void 0:n.url)&&(e=ae.includes("from_details=true")?"/insights".concat(r.url):T._.insightsInventory),re===T._.fleetManagementSystemDetailUpdate&&(e=ae.includes("from_details=true")?T._.fleetManagementSystemDetail:T._.fleetManagementDetail),void 0!==j)te({pathname:e});else{var a=e.split("/").length,l=re.split("/").slice(0,a).join("/");ee.push({pathname:l})}},oe=function(e){var t,n=null==e?void 0:e.Version;return{cells:[n,O.aN[null==e?void 0:e.Distribution],(null==e||null===(t=e.Packages)||void 0===t?void 0:t.length)||0,null==e?void 0:e.TotalPackages,null==e?void 0:e.SystemsRunning,c().createElement("span",null,c().createElement(I.Z,{type:"relative",date:null==e?void 0:e.CreatedAt}))],commitID:null==e?void 0:e.CommitID,deviceUUID:null==W?void 0:W.UUID,deviceName:null==W?void 0:W.DeviceName,selected:V===n}},ce=oe(null==d||null===(t=d.ImageInfo)||void 0===t?void 0:t.Image),se=null==d||null===(n=d.ImageInfo)||void 0===n||null===(l=n.UpdatesAvailable)||void 0===l?void 0:l.map((function(e){return oe(null==e?void 0:e.Image)}));return c().createElement(y.T,null,c().createElement(E.NP,{isWidthLimited:!0},c().createElement(f.Z,null,c().createElement(g.e,null,c().createElement(R,{image:ce}),c().createElement(D.D,null,c().createElement(w.D,{headingLevel:"h2"},c().createElement(P.x,{className:"pf-u-mt-md"},"Select version to update to"))),c().createElement(c().Fragment,null,c().createElement(s.Z,{historyProp:S,navigateProp:j,locationProp:N,className:"pf-u-mt-sm",apiFilterSort:!0,isUseApi:!0,loadTableData:p,filters:A,tableData:{count:null==d||null===(u=d.ImageInfo)||void 0===u?void 0:u.Count,isLoading:m,hasError:b},columnNames:M,rows:se,defaultSort:{index:0,direction:"desc"},hasRadio:!0,setRadioSelection:function(e){B(e.cells[0]),H(e)},isFooterFixed:!0}),c().createElement("div",{style:{background:"white",left:"200px",position:"fixed",height:"90px",width:"100%",bottom:"0px",paddingLeft:"80px",paddingBottom:"0px"}},c().createElement(h.i,{style:{paddingBottom:"25px",width:"100%",paddingLeft:0}}),c().createElement(v.zx,{style:{left:"60px"},key:"confirm",variant:"primary",isDisabled:!V||K,onClick:function(){return le()}},"Update system"),c().createElement(v.zx,{style:{left:"70px"},key:"cancel",variant:"link",onClick:ie},"Cancel")))))))};W.propTypes={data:d().oneOfType([d().object,d().array]),historyProp:d().func,navigateProp:d().func,locationProp:d().func,routeMatchProp:d().func,fetchDevices:d().func,isLoading:d().bool,hasError:d().bool,currentId:d().string,notificationProp:d().object};var F=function(e){var t,n,r,l,i=e.inventoryId,o=e.historyProp,s=e.navigateProp,u=e.locationProp,d=e.routeMatchProp,v=e.paramsProp,f=e.notificationProp,g=o?o():_.k6?(0,_.k6)():null,h=v?v():_.UO?(0,_.UO)():null,y=h.deviceId,E=h.groupId,w=i||y,O=window.location.pathname.indexOf("edge")>0?"edge":T._.inventory,k=(0,N.Z)({api:x.V3,id:w,tableReload:!0}),I=(0,a.Z)(k,2),Z=I[0],U=Z.data,L=Z.isLoading,A=Z.hasError,M=I[1],R=null==U?void 0:U.Device,F=E?null==R||null===(t=R.DevicesGroups)||void 0===t||null===(n=t.find((function(e){return e.ID.toString()===E})))||void 0===n?void 0:n.Name:null;return c().createElement(c().Fragment,null,c().createElement(S.Z,{className:"pf-m-light"},F?c().createElement(p.a,{ouiaId:"groups-list"},c().createElement(m.g,null,(0,C.EW)({pathname:T._.fleetManagement,linkText:"Groups",history:g})),c().createElement(m.g,null,(0,C.EW)({pathname:"".concat(T._.fleetManagement,"/").concat(E),linkText:F||c().createElement(b.O,{width:"100px"}),history:g})),c().createElement(m.g,null,(0,C.EW)({pathname:"".concat(T._.fleetManagement,"/").concat(E,"/systems/").concat(w,"/"),linkText:null==R?void 0:R.DeviceName,history:g})),c().createElement(m.g,null,"Update")):c().createElement(p.a,{ouiaId:"systems-list"},c().createElement(m.g,null,(0,C.EW)({pathname:"edge"===O?"".concat(O,"/inventory"):"insights".concat(O,"/manage-edge-inventory"),linkText:"Systems",history:g})),c().createElement(m.g,null,(0,C.EW)({pathname:"edge"===O?"".concat(O,"/inventory/").concat(w,"/"):"insights".concat(O,"/").concat(w),linkText:(null==R?void 0:R.DeviceName)||c().createElement(b.O,{width:"100px"}),history:g})),c().createElement(m.g,null,"Update")),c().createElement(j.Z,{title:"Update"}),c().createElement(D.D,{className:"pf-u-mt-md"},null!=R&&R.DeviceName?c().createElement(P.x,null,"Update ",c().createElement("strong",null,null==R?void 0:R.DeviceName)," to a newer version of ",c().createElement("strong",null,null==U||null===(r=U.ImageInfo)||void 0===r||null===(l=r.Image)||void 0===l?void 0:l.Name)," by selecting a new version from the table below."):c().createElement(b.O,{width:"100px"}))),c().createElement("section",{className:"edge-devices pf-l-page__main-section pf-c-page__main-section"},c().createElement(W,{data:U,currentId:w,fetchDevices:M,isLoading:L,hasError:A,navigateProp:s,histor:!0,yProp:o,locationProp:u,routeMatchProp:d,notificationProp:f})))};F.propTypes={historyProp:d().func,navigateProp:d().func,locationProp:d().func,routeMatchProp:d().func,paramsProp:d().func,inventoryId:d().string,notificationProp:d().object};const q=F},96094:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(4942),a=n(15861),l=n(29439),i=n(64687),o=n.n(i),c=n(83215),s=n(92950),u=n(77760);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const m=function(e){var t,n=e.api,r=e.id,i=void 0===r?null:r,d=e.statusMessages,m=e.tableReload,v=void 0!==m&&m,f=(0,u.useDispatch)(),g=(0,s.useState)([]),h=(0,l.Z)(g,2),y=h[0],E=h[1],b=(0,s.useState)(!0),P=(0,l.Z)(b,2),D=P[0],w=P[1],x=(0,s.useState)(!1),O=(0,l.Z)(x,2),k=O[0],T=O[1],I=(0,s.useState)((function(){return n})),S=(0,l.Z)(I,2),j=S[0],N=S[1],Z=null===(t=d)||void 0===t?void 0:t.onSuccess;d||(d={onSuccess:{title:"Success",description:"The request has been made successfully"},onError:{title:"Error",description:"An error occurred making the request"}});var _=function(){var e=(0,a.Z)(o().mark((function e(){var t,n,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",w(!0),e.prev=2,e.next=5,j({id:i,query:t});case 5:n=e.sent,E(n),Z&&f(p({},(0,c.wN)(p({variant:"success"},d.onSuccess)))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),T(!0),f(p({},(0,c.wN)(p({variant:"danger"},d.onError))));case 14:return e.prev=14,w(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,10,14,17]])})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){v||_()}),[]),[{data:y,isLoading:D,hasError:k},_,j,N]}},32349:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(4942),a=n(15861),l=n(64687),i=n.n(l),o=n(83215);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const u=function(e,t,n,r){var l,c,u,d=null===(l=n)||void 0===l?void 0:l.onSuccess,p=null===(c=n)||void 0===c?void 0:c.onInfo,m=null===(u=n)||void 0===u?void 0:u.onWarning;n||(n={onSuccess:{title:"Success",description:"The request has been made successfully"},onError:{title:"Error",description:"An error occurred making the request"}});var v=function(){var l=(0,a.Z)(i().mark((function a(){var l;return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t();case 3:return l=a.sent,p&&(r?r.hasInfo(n.onInfo):e(s({},(0,o.wN)(s({variant:"info"},n.onInfo))))),d&&(r?r.hasSuccess(n.onSuccess):e(s({},(0,o.wN)(s({variant:"success"},n.onSuccess))))),m&&(r?r.hasWarning(n.onWarning):e(s({},(0,o.wN)(s({variant:"warning"},n.onWarning))))),a.abrupt("return",l);case 10:return a.prev=10,a.t0=a.catch(0),r?r.err(n.onError,a.t0):e(s({},(0,o.wN)(s(s({variant:"danger"},n.onError),{},{description:null!==a.t0&&void 0!==a.t0&&a.t0.Title?"".concat(n.onError.description,": ").concat(a.t0.Title):n.onError.description})))),a.abrupt("return",a.t0);case 14:case"end":return a.stop()}}),a,null,[[0,10]])})));return function(){return l.apply(this,arguments)}}();return v()}},58392:()=>{},80598:()=>{},10108:()=>{},80897:()=>{},92084:()=>{}}]);
//# sourceMappingURL=../sourcemaps/UpdateSystem.e673e9126003cb3ebdc27a6478acbb47.js.map