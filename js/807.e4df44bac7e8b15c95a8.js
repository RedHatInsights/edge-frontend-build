(self.webpackChunkinsights_frontend_starter_app=self.webpackChunkinsights_frontend_starter_app||[]).push([[807],{1005:(e,t,n)=>{"use strict";n.d(t,{Ud:()=>w,oG:()=>T,B9:()=>y,l9:()=>x,j7:()=>p,bR:()=>k});var a=n(63038),r=n.n(a),i=n(1427),l=n.n(i),s=n(47173),o=n(6468),c=n(70363),u=n(45697),d=n.n(u),m=function(e){var t=e.buttonLabels,n=t.cancel,a=t.submit,u=t.back,d=(0,i.useState)(!1),m=r()(d,2),p=m[0],v=m[1],g=(0,i.useContext)(c.default),h=g.handlePrev,f=g.formOptions;return l().createElement(o.lP,null,(function(){return l().createElement(l().Fragment,null,l().createElement(s.zx,{variant:"primary",type:"button",isDisabled:!f.valid||f.getState().validating||p,onClick:function(){f.onSubmit({values:f.getState().values,setIsSaving:v})}},a),l().createElement(s.zx,{type:"button",variant:"secondary",onClick:h,isDisabled:p},u),l().createElement("div",{className:"pf-c-wizard__footer-cancel"},l().createElement(s.zx,{type:"button",variant:"link",onClick:f.onCancel,isDisabled:p},n)))}))};m.propTypes={buttonLabels:d().shape({cancel:d().node,submit:d().node,back:d().node}),isSaving:d().bool};const p={name:"review",title:"Review",buttons:m,fields:[{name:"review",component:"review"}]};var v=n(96354),g=n(68340),h=n(68774),f=n(48880),b=n(68920),E=function(){var e,t,n=null===(e=(0,(0,f.default)().getState)())||void 0===e||null===(t=e.values)||void 0===t?void 0:t.release,a=void 0!==n?b.Ei[n]:"";return l().createElement(h.D,null,l().createElement(g.x,null,"Add packages to your ",l().createElement(g.x,{component:"b"},a)," image."))};const y={title:"Additional packages",name:"packages",nextStep:"review",fields:[{component:v.Z.PLAIN_TEXT,name:"google-cloud-text-component",label:l().createElement(E,null)},{component:"package-selector",name:"selected-packages",label:"Available options",initialValue:[],clearedValue:[]}]};var O=n(64124);const w={title:"Options",name:"imageOutput",nextStep:function(e){var t,n=e.values;return(null==n||null===(t=n.imageType)||void 0===t?void 0:t.includes("rhel-edge-installer"))||!n.imageType?"registration":"packages"},fields:[{component:v.Z.PLAIN_TEXT,name:"description",label:l().createElement(g.x,null,"Enter some basic information about your image.")},{component:v.Z.SELECT,name:"release",label:"Release",options:Object.entries(b.Ei).map((function(e){var t=r()(e,2);return{value:t[0],label:t[1]}})),initialValue:b.az,validate:[{type:O.Z.REQUIRED}],isRequired:!0,isDisabled:!0},{component:"image-output-checkbox",name:"imageType",options:Object.entries(b.bd).map((function(e){var t=r()(e,2);return{value:t[0],label:t[1]}})),initialValue:["rhel-edge-installer","rhel-edge-commit"],clearedValue:[],validate:[{type:O.Z.REQUIRED}]}]},T={title:"Details",name:"imageSetDetails",nextStep:"imageOutput",fields:[{component:v.Z.PLAIN_TEXT,name:"description",label:l().createElement(g.x,null,"Enter a name and description to easily identify your image later.")},{component:v.Z.TEXT_FIELD,name:"name",label:"Image name",placeholder:"Image name",validate:[{type:O.Z.REQUIRED},{type:O.Z.PATTERN,pattern:/^[A-Za-z0-9]+[A-Za-z0-9_-\s]*$/},{type:O.Z.MAX_LENGTH,threshold:50}],isRequired:!0},{component:v.Z.TEXTAREA,name:"description",label:"Description",placeholder:"Add description",resizeOrientation:"vertical",validate:[{type:O.Z.MAX_LENGTH,threshold:250}]}]},k={title:"Details",name:"imageSetDetails",nextStep:"imageOutput",fields:[{component:v.Z.PLAIN_TEXT,name:"description",label:l().createElement(g.x,null,"Enter a description to easily identify your image later.")},{component:v.Z.TEXT_FIELD,name:"description",label:"Description",placeholder:"Add description",validate:[{type:O.Z.MAX_LENGTH,threshold:250}]}]};var S=n(36621),P=n(53620);const x={title:"Device registration",name:"registration",nextStep:"packages",fields:[{component:v.Z.PLAIN_TEXT,name:"description",label:l().createElement(g.x,null,"Use this to log into your device.")},{component:v.Z.TEXT_FIELD,label:"Username",placeholder:"Enter username",helperText:l().createElement(S.p,null,l().createElement(P.u,{className:"pf-u-mt-xs",variant:"indeterminate"},"Can only contain letters, numbers, hyphen ( - ), and underscores( _ ).")),name:"username",validate:[{type:O.Z.REQUIRED},{type:O.Z.PATTERN,pattern:/^[A-Za-z0-9]+[A-Za-z0-9_-]*$/,message:"Can only contain letters, numbers, hyphen ( - ), and underscores( _ )."},{type:O.Z.MAX_LENGTH,threshold:50}],isRequired:!0},{component:"ssh-input-field",name:"credentials",validate:[{type:O.Z.REQUIRED},{type:O.Z.PATTERN,pattern:/^(ssh-(rsa|dss|ed25519)|ecdsa-sha2-nistp(256|384|521)) \S+/}],isRequired:!0}]}},10728:(e,t,n)=>{"use strict";n.d(t,{Z:()=>re});var a=n(59713),r=n.n(a),i=n(67154),l=n.n(i),s=n(1427),o=n.n(s),c=n(95960),u=n(67850),d=n(71843),m=n(2372),p=n(45697),v=n.n(p),g=n(20873),h=n(87757),f=n.n(h),b=n(48926),E=n.n(b),y=n(63038),O=n.n(y),w=n(6479),T=n.n(w),k=n(48880),S=n(11511),P=n(15110),x=n(47173),Z=n(68774),A=n(66702),j=function(e){return e.map((function(e,t){return o().createElement(Z.D,{key:"".concat(e.name,"-").concat(t)},o().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),o().createElement("small",null,e.summary))}))},C=function(e){return{name:e.props.children[0].props.children,summary:e.props.children[1].props.children}},D=function(e){var t=e.defaultArch,n=T()(e,["defaultArch"]),a=(0,k.default)(),r=a.change,i=a.getState,l=(0,S.Z)(n).input,c=(0,s.useRef)(),u=(0,s.useState)([]),d=O()(u,2),m=d[0],p=d[1],v=(0,s.useState)([]),g=O()(v,2),h=g[0],b=g[1],y=(0,s.useState)(""),w=O()(y,2),Z=w[0],D=w[1];(0,s.useEffect)((function(){var e,t;b(j((null===(e=i())||void 0===e||null===(t=e.values)||void 0===t?void 0:t[l.name])||[]));var n=document.querySelector('[aria-label="Available search input"]');return null==n||n.addEventListener("keydown",N),function(){return n.removeEventListener("keydown",N)}}),[]);var R=function(e,t){var n=t.map(C);p(e),b(t),r(l.name,n)},_=function(){var e=E()(f().mark((function e(){var n,a,r,l,s,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.EV)((null===(n=i())||void 0===n||null===(a=n.values)||void 0===a?void 0:a.release)||"rhel-8",(null===(r=i())||void 0===r||null===(l=r.values)||void 0===l?void 0:l.architecture)||t,c.current);case 2:s=e.sent,o=s.data,p(j(o||[]));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(e){"Enter"===e.key&&(e.stopPropagation(),_())};return o().createElement(P.I,{className:"pf-u-mt-sm",isSearchable:!0,availableOptionsActions:[o().createElement(x.zx,{"aria-label":"Search button for available packages",key:"availableSearchButton","data-testid":"search-pkgs-button",onClick:_},"Search")],availableOptions:m,availableOptionsTitle:"Available packages",chosenOptions:h.filter((function(e){var t,n;return null===(t=C(e))||void 0===t||null===(n=t.name)||void 0===n?void 0:n.includes(Z)})),chosenOptionsTitle:"Chosen packages",addSelected:R,removeSelected:R,addAll:R,removeAll:function(e){return R(e,h.filter((function(e){var t,n;return!(null===(t=C(e))||void 0===t||null===(n=t.name)||void 0===n?void 0:n.includes(Z))})))},onAvailableOptionsSearchInputChanged:function(e){c.current=e},onChosenOptionsSearchInputChanged:function(e){return D(e)},filterOption:function(){return!0},id:"basicSelectorWithSearch"})};D.propTypes={defaultArch:v().string};const R=D;var _=n(319),N=n.n(_),I=n(43627),L=n(93149),q=n(92607),V=n(87346);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(){return function(e,t){if(0===e.length)return{checkbox:"select at least one validation method"};var n={};return!e.includes("password")||void 0!==t.password&&""!==t.password||(n=F(F({},n),{},{password:"Required"})),!e.includes("sshKey")||void 0!==t.sshKey&&""!==t.sshKey||(n=F(F({},n),{},{sshKey:"Required"})),n}};const U=function(e){var t=(0,S.Z)(e),n=t.input,a=t.meta,r=(0,s.useCallback)((function(e,t){n.onChange(e?[].concat(N()(n.value),[t.currentTarget.id]):n.value.filter((function(e){return e!==t.currentTarget.id})))}),[n.onChange]),i=(0,S.Z)({name:"password"}).input,c=(0,S.Z)({name:"sshKey"}).input;return o().createElement(I.c,{label:"Select at least one to validate credentials",isHelperTextBeforeField:!0,hasNoPaddingTop:!0,isRequired:!0,isStack:!0},o().createElement(L.X,{label:"Password",id:"password",isChecked:n.value.includes("password"),onChange:r}),n.value.includes("password")?o().createElement(I.c,{helperTextInvalid:a.dirty&&void 0!==a.error.password?a.error.password:void 0},o().createElement(q.oi,l()({type:"password"},i))):null,o().createElement(L.X,{label:"SSH",id:"sshKey",isChecked:n.value.includes("sshKey"),onChange:r}),n.value.includes("sshKey")?o().createElement(I.c,{helperTextInvalid:a.dirty&&void 0!==a.error.sshKey?a.error.sshKey:void 0},o().createElement(V.Kx,c)):null)};var z=n(68340),H=n(36621),G=n(53620),M=n(15265),Q=function(){return o().createElement(H.p,{className:"pf-u-ml-lg",hasIcon:!0},o().createElement(G.u,{className:"pf-u-pb-md",variant:"warning",hasIcon:!0},"Creating an installable version of your image increases the build time and is not needed for updating existing devices. ",o().createElement("br",null),"You can create an installable version of this image later if you continue with this option"))},B={"rhel-edge-commit":"An OSTree commit is always created when building an image.","rhel-edge-installer":"An installable version of the image is typically created with a brand new image."},$=function(e){var t=(0,k.default)().getState,n=(0,S.Z)(e).input,a=(0,s.useCallback)((function(e,t){n.onChange(e?[].concat(N()(n.value),[t.currentTarget.id]):n.value.filter((function(e){return e!==t.currentTarget.id})))}),[n.onChange]);return o().createElement(I.c,{label:"Output type",isHelperTextBeforeField:!0,hasNoPaddingTop:!0,isRequired:!0,isStack:!0},e.options.map((function(e,r){var i,l,s=e.value,c=e.label;return o().createElement(o().Fragment,null,o().createElement(L.X,{key:r,label:c,id:s,isChecked:n.value.includes(s),onChange:a,isDisabled:"rhel-edge-commit"===s}),o().createElement(Z.D,null,(null===(i=t())||void 0===i||null===(l=i.initialValues)||void 0===l?void 0:l.isUpdate)&&"rhel-edge-installer"===s?o().createElement(Q,null):o().createElement(H.p,{className:"pf-u-ml-lg pf-u-pb-sm"},o().createElement(G.u,{variant:"indeterminate"},B[s])),"rhel-edge-installer"===s&&o().createElement(z.x,{component:z.q.small},o().createElement(z.x,{className:"pf-u-ml-lg",component:z.q.a,isVisitedLink:!0},"Learn more about image types.",o().createElement(M.ZP,{className:"pf-u-ml-sm"})))))})))};$.propTypes={input:v().array,options:v().arrayOf(v().shape({value:v().string,label:v().string}))};const Y=$;function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}const J=function(e){var t=(0,S.Z)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"credentials"},e)),n=t.input,a=t.meta;return o().createElement(I.c,null,o().createElement(I.c,{label:"SSH key",helperTextInvalid:a.error,validated:a.error&&a.touched?"error":"default",isRequired:!0},o().createElement(V.Kx,l()({className:"pf-u-h-25vh",id:"credentials",placeholder:"Paste your public SSH key"},n))),o().createElement(s.Fragment,null,o().createElement(z.x,{component:z.q.small},o().createElement(z.x,{target:"_blank",href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/using-secure-communications-between-two-systems-with-openssh_configuring-basic-system-settings#generating-ssh-key-pairs_using-secure-communications-between-two-systems-with-openssh",isVisitedLink:!0,component:z.q.a},"Learn more about SSH keys",o().createElement(M.ZP,{className:"pf-u-ml-sm"})))))};var ee=n(64124);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=e.schema,n=e.onSubmit,a=e.onClose,r=e.customComponentMapper,i=e.initialValues,s=e.defaultArch;return t?o().createElement(c.Z,{schema:t,className:"image-builder",subscription:{values:!0},FormTemplate:function(e){return o().createElement(u.ZP,l()({},e,{showFormControls:!1}))},onSubmit:function(e){return n(e)},initialValues:i,componentMapper:ne(ne({},d.YS),{},{"registration-creds":{component:U},"image-output-checkbox":{component:Y},"ssh-input-field":{component:J},review:g.Z,"package-selector":{component:R,defaultArch:s}},r),validatorMapper:ne(ne({},ee.Z),{},{registrationCredsValidator:K}),onCancel:a}):o().createElement(m.$,null)};ae.propTypes={schema:v().object,initialValues:v().object,onSubmit:v().func.isRequired,onClose:v().func.isRequired,customComponentMapper:v().shape(r()({},v().string,v().oneOfType([v().node,v().shape({component:v().node})]))),defaultArch:v().string};const re=ae},20873:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var a=n(1427),r=n.n(a),i=n(68774),l=n(68340),s=n(48880),o=n(68920),c=n(80962),u=n(59245),d=n(96667),m=n(52643),p=n(2372),v=n(35540),g=n(50693),h=n(16475),f=n(45454),b=n(45697),E=n.n(b),y=function(e){var t=e.title,n=e.data,a=e.testid;return r().createElement(g.r,{className:"pf-u-pb-xl","data-testid":a,hasGutter:!0},r().createElement(h.P,{span:12,hasGutter:!0},r().createElement(l.x,{component:l.q.h2},t)),n.map((function(e){var t=e.name,n=e.value;return r().createElement(r().Fragment,null,r().createElement(h.P,{span:3,hasGutter:!0},r().createElement(f.T,{component:f.v.dt},t)),r().createElement(h.P,{span:9,hasGutter:!0},r().createElement(f.T,{component:f.v.dd},n)))})))};y.propTypes={title:E().string,data:E().arrayOf(E().shape({name:E().string,value:E().string})),testid:E().string};const O=y,w=function(){var e=(0,s.default)().getState,t=e().initialValues.isUpdate,n=(0,a.useContext)(u.g).getRegistry,g=(0,c.useSelector)((function(e){var t=e.createImageReducer;return{isLoading:void 0!==(null==t?void 0:t.isLoading)&&(null==t?void 0:t.isLoading),hasError:(null==t?void 0:t.hasError)||!1,error:(null==t?void 0:t.error)||null}}),c.shallowEqual),h=g.isLoading,f=g.hasError;if((0,a.useEffect)((function(){var e=n().register({createImageReducer:d.Ch});return function(){return e()}}),[]),h)return r().createElement(m.b,null,r().createElement(p.$,null));var b,E,y=[{name:"Name",value:e().values.name},{name:"Version",value:e().initialValues.version+1},{name:"Description",value:e().values.description}],w=[{name:"Username",value:e().values.username},{name:"ssh-key",value:e().values.credentials}],T=e().initialValues["selected-packages"],k=e().values["selected-packages"],S=function(e,t){return e.reduce((function(e,n){var a=n.name;return e+(t.some((function(e){return e.name===a}))?0:1)}),0)};return r().createElement(a.Fragment,null,f&&r().createElement(v.b,{variant:"danger",title:"Failed sending the request: Edge API is not available"}),r().createElement(i.D,null,r().createElement(l.x,null,"Review the information and click"," ",r().createElement(l.x,{component:"b"},"Create image")," to start the build process."),r().createElement(O,{title:"Details",data:y,testid:"review-image-details"}),r().createElement(O,{title:"Output",data:(E=[{name:"Release",value:o.Ei[e().values.release]},{name:"Output Type",value:o.bd["rhel-edge-commit"]}],e().values.imageType.includes("rhel-edge-installer")&&E.push({name:"",value:o.bd["rhel-edge-installer"]}),E),testid:"review-image-output"}),e().values.imageType.includes("rhel-edge-installer")?r().createElement(O,{title:"Registration",data:w,testid:"review-image-registration"}):null,r().createElement(O,{title:"Packages",data:(b=[{name:"Added",value:S(k,T)}],t?[].concat(b,[{name:"Removed",value:S(T,k)},{name:"Updated",value:0}]):b),testid:"review-image-packages"})))}}}]);
//# sourceMappingURL=../sourcemaps/807.93e04c453c3a4d447512.js.map