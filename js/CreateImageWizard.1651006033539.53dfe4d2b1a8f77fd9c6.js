"use strict";(self.webpackChunkinsights_frontend_starter_app=self.webpackChunkinsights_frontend_starter_app||[]).push([[344,940],{68940:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var a=n(4942),r=n(15861),i=n(87757),o=n.n(i),l=n(75418),c=n.n(l),s=n(68774),u=n(68340),d=n(69957),p=n(45697),m=n.n(p),v=n(66702),f=n(28216),g=n(83215),b=n(60722),h=n(96354),y=n(60485),O=n(78140),w=n(25834),D=function(e){var t=e.reviewObject,n=e.key;return c().createElement(s.D,null,c().createElement(y.D,{headingLevel:"h3"},c().createElement(u.x,{component:"b"},t.title)),c().createElement(w.G,{component:w.F.dl},t.rows.map((function(e){return c().createElement(l.Fragment,{key:e.title+n},c().createElement(O.T,{component:O.v.dt},e.title),c().createElement(O.T,{component:O.v.dd},e.value))}))))};D.propTypes={reviewObject:m().object,key:m().string};const E=D;var j=n(62410),I=n(68920);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t,n,a,i,l,p,m,y=e.updateModal,O=e.setUpdateModal,w=e.refreshTable,D=(0,f.I0)(),P=null==y?void 0:y.imageData,T=y.deviceData.length>1,N=y.deviceData.map((function(e){return e.id})),_=T?y.deviceData.map((function(e){return e.display_name})):null==y||null===(t=y.deviceData[0])||void 0===t?void 0:t.display_name,U=function(){var e=(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,v.g5)({DevicesUUID:N,CommitId:null==P||null===(t=P.Image)||void 0===t?void 0:t.CommitID});case 3:D(k({},(0,g.wN)({variant:"info",title:"Updating device",description:T?" ".concat(_.length," systems were added to the queue."):" ".concat(_," was added to the queue.")}))),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),D(k({},(0,g.wN)({variant:"danger",title:"Updating a device was unsuccessful",description:"Response: ".concat(e.t0.statusText)})));case 9:C(),w&&w();case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),C=function(){O((function(e){return k(k({},e),{},{isOpen:!1})}))},Z={title:"Update to version ".concat(null==P?void 0:P.Image.Version),rows:[{title:"Image Name",value:null==P?void 0:P.Image.Name},{title:"Version",value:null==P?void 0:P.Image.Version},{title:"Created",value:c().createElement(j.Z,{date:null==P?void 0:P.Image.CreatedAt})},{title:"Release",value:I.aN[null==P?void 0:P.Image.Distribution]}]},R={title:"Changes from version ".concat((null==P?void 0:P.Image.Version)-1),rows:[{title:"Added",value:(null==P||null===(n=P.PackageDiff)||void 0===n||null===(a=n.Added)||void 0===a?void 0:a.length)||0},{title:"Removed",value:(null==P||null===(i=P.PackageDiff)||void 0===i||null===(l=i.Removed)||void 0===l?void 0:l.length)||0},{title:"Updated",value:(null==P||null===(p=P.PackageDiff)||void 0===p||null===(m=p.Updated)||void 0===m?void 0:m.length)||0}]},S={fields:[{component:h.Z.PLAIN_TEXT,name:"description",label:c().createElement(s.D,null,c().createElement(u.x,null,"Update"," ",c().createElement("span",{className:"pf-u-font-weight-bold pf-u-font-size-md"},T?"".concat(_.length," systems"):_)," ","to latest version of the image linked to it."))},{component:h.Z.PLAIN_TEXT,name:"update-details",label:E({reviewObject:Z,key:"update-details"})},{component:h.Z.PLAIN_TEXT,name:"package-details",label:E({reviewObject:R,key:"package-details"})},{component:h.Z.PLAIN_TEXT,name:"warning-text",label:c().createElement(s.D,{className:"pf-u-pt-md"},c().createElement(u.x,{style:{color:"var(--pf-global--palette--gold-500)"},component:"small"},c().createElement(d.ZP,null)," After the update is installed, the device will apply the changes."))}]};return c().createElement(b.Z,{size:"medium",title:"Update system".concat(T?"s":""," to latest image version"),isOpen:y.isOpen,openModal:function(){return O((function(e){return k(k({},e),{},{isOpen:!1})}))},submitLabel:"Update Device",schema:S,onSubmit:U,reloadData:w})};T.propTypes={refreshTable:m().func,updateModal:m().shape({isOpen:m().bool.isRequired,deviceData:m().array.isRequired,imageData:m().object}).isRequired,setUpdateModal:m().func.isRequired};const N=T},49477:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(4942),r=n(15861),i=n(29439),o=n(87757),l=n.n(o),c=n(75418),s=n.n(c),u=n(82951),d=n(96354),p=n(52251),m=n(2372),v=n(45697),f=n.n(v),g=n(20873),b=n(94778),h=n(59086),y=n(28216),O=n(83215),w=n(66702),D=n(58061);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){var t=e.navigateBack,n=(0,c.useState)(),a=(0,i.Z)(n,2),o=a[0],v=a[1],f=(0,y.I0)(),E=(0,D.gV)("fleet-management.custom-repos"),I=function(){t(),f({type:h.G})};return(0,c.useEffect)((function(){(0,r.Z)(l().mark((function e(){var t,n,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(a=n.auth)||void 0===a||a.getUser().then((function(e){return v(null!=e?e:{})}));case 1:case"end":return e.stop()}}),e)})))()}),[]),o?s().createElement(u.Z,{onClose:I,customComponentMapper:{review:g.Z},onSubmit:function(e){var t=e.values;(0,e.setIsSaving)((function(){return!0}));var n=j(j({},t),{},{architecture:"x86_64"});(0,b.Es)(f,n,(function(e){f(j(j({},(0,O.wN)({variant:"info",title:"Created image",description:"".concat(e.value.Name," image was added to the queue.")})),{},{meta:{polling:{id:"FETCH_IMAGE_".concat(e.value.ID,"_BUILD_STATUS"),fetcher:function(){return(0,w.EC)(e.value.ID)},condition:function(e){switch(e.Status){case"BUILDING":return[!0,""];case"ERROR":return[!1,"failure"];default:return[!1,"success"]}},onEvent:{failure:[function(t){return t((0,O.wN)({variant:"danger",title:"Image build failed",description:"".concat(e.value.Name," image build is completed unsuccessfully")}))}],success:[function(t){return t((0,O.wN)({variant:"success",title:"Image is ready",description:"".concat(e.value.Name," image build is completed")}))},function(e){return(0,b.n9)(e)}]}}}})),(0,b.n9)(f),I()}))},defaultArch:"x86_64",initialValues:{version:0,includesCustomRepos:E},schema:{fields:[{component:d.Z.WIZARD,name:"image-builder-wizard",className:"image-builder",isDynamic:!0,inModal:!0,buttonLabels:{submit:"Create image"},showTitles:!0,title:"Create image",crossroads:["target-environment","release","imageType","third-party-repositories","imageOutput","imageSetDetails","includesCustomRepos"],fields:[p.oG,p.Ud,p.l9,p.jS,p.B9,p.j7,p.Sp]}]}}):s().createElement(m.$,null)};I.propTypes={navigateBack:f().func},I.defaultProps={navigateBack:function(){}};const P=I}}]);
//# sourceMappingURL=../sourcemaps/CreateImageWizard.1a9d1aa7f6c4322168c034d3320a6ef1.js.map