(self.webpackChunkedge_frontend=self.webpackChunkedge_frontend||[]).push([[2805],{66581:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>V});var r=n(15861),a=n(29439),c=n(64687),l=n.n(c),o=n(92950),i=n.n(o),s=n(73448),u=n(45697),d=n.n(u),p=n(64029),m=n(32835),v=n(47173),f=n(32203),g=n(62394),h=n(15627),E=n(16488),y=n(32045),b=n(50383),D=n(68340),P=n(68774),w=n(38779),O=n(8027),k=n(98309),x=n(77760),S=n(9192),I=n(62410),T=n(89376),j=n(39173),Z=n(96094),L=n(34766),N=n(79142),_=n(32349),U=[{label:"Version",type:"text"},{label:"Release",type:"text"},{label:"Additional packages",type:"text"},{label:"All packages",type:"text"},{label:"Systems running",type:"text"},{label:"Created",type:"text"}],C=[{title:"Version",cellTransforms:[(0,L.headerCol)("selectable-radio")]},{title:"Release"},{title:"Additional packages"},{title:"All packages"},{title:"Systems running"},{title:"Created"}],M=function(e){var t=e.image,n=[{version:t.cells[0],release:t.cells[1],additionalPackages:t.cells[2],allPackages:t.cells[3],systemsRunning:t.cells[4],created:t.cells[5]}],r="Version",a="Release",c="Additional packages",l="All packages",o="Systems running",s="Created";return i().createElement(i().Fragment,null,i().createElement(P.D,null,i().createElement(w.D,{headingLevel:"h2"},i().createElement(D.x,null,"Current version"))),i().createElement(L.TableComposable,{"aria-label":"Current version table",variant:"compact",borders:!1},i().createElement(L.Thead,null,i().createElement(L.Tr,{style:{borderBottomStyle:"hidden"}},i().createElement(L.Th,{style:{width:"3%"}}),i().createElement(L.Th,null,r),i().createElement(L.Th,null,a),i().createElement(L.Th,null,c),i().createElement(L.Th,null,l),i().createElement(L.Th,null,o),i().createElement(L.Th,null,s))),i().createElement(L.Tbody,null,n.map((function(e,t){return i().createElement(L.Tr,{key:t},i().createElement(L.Td,null),i().createElement(L.Td,{dataLabel:r},e.version),i().createElement(L.Td,{dataLabel:a},e.release),i().createElement(L.Td,{dataLabel:c},e.additionalPackages),i().createElement(L.Td,{dataLabel:l},e.allPackages),i().createElement(L.Td,{dataLabel:o},e.systemsRunning),i().createElement(L.Td,{dataLabel:s},e.created))})))))};M.propTypes={image:d().object};var A=function(e){var t,n,c,u,d=e.data,p=e.fetchDevices,m=e.isLoading,b=e.hasError,T=e.historyProp,j=e.locationProp,Z=e.routeMatchProp,L=null==d?void 0:d.Device,A=(0,o.useState)(null),R=(0,a.Z)(A,2),V=R[0],q=R[1],F=(0,o.useState)(null),B=(0,a.Z)(F,2),z=B[0],G=B[1],Q=(0,o.useState)(!1),$=(0,a.Z)(Q,2),H=$[0],J=$[1],W=(0,x.useDispatch)(),K=T?T():(0,N.useHistory)(),X=j?j():(0,N.useLocation)(),Y=X.pathname,ee=X.search,te=Z?Z():(0,N.useRouteMatch)(),ne=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),t={onInfo:{title:"Updating system",description:" ".concat(z.deviceName," was added to the queue.")},onError:{title:"Error",description:"Failed to update the selected system(s)"}},e.next=4,(0,_.Z)(W,(function(){return(0,O.EQ)({CommitID:z.commitID,DevicesUUID:[z.deviceUUID]})}),t);case 4:re(),J(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=S._.inventory;te.path===S._.inventoryDetailUpdate&&(e=ee.includes("from_details=true")?S._.inventoryDetail:S._.inventory),te.path===S._.fleetManagementSystemDetailUpdate&&(e=ee.includes("from_details=true")?S._.fleetManagementSystemDetail:S._.fleetManagementDetail);var t=e.split("/").length,n=Y.split("/").slice(0,t).join("/");K.push({pathname:n})},ae=function(e){var t,n=null==e?void 0:e.Version;return{cells:[n,k.aN[null==e?void 0:e.Distribution],(null==e||null===(t=e.Packages)||void 0===t?void 0:t.length)||0,null==e?void 0:e.TotalPackages,null==e?void 0:e.SystemsRunning,i().createElement("span",null,i().createElement(I.Z,{type:"relative",date:null==e?void 0:e.CreatedAt}))],commitID:null==e?void 0:e.CommitID,deviceUUID:null==L?void 0:L.UUID,deviceName:null==L?void 0:L.DeviceName,selected:V===n}},ce=ae(null==d||null===(t=d.ImageInfo)||void 0===t?void 0:t.Image),le=null==d||null===(n=d.ImageInfo)||void 0===n||null===(c=n.UpdatesAvailable)||void 0===c?void 0:c.map((function(e){return ae(null==e?void 0:e.Image)}));return i().createElement(E.T,null,i().createElement(y.NP,{isWidthLimited:!0},i().createElement(f.Z,null,i().createElement(g.e,null,i().createElement(M,{image:ce}),i().createElement(P.D,null,i().createElement(w.D,{headingLevel:"h2"},i().createElement(D.x,{className:"pf-u-mt-md"},"Select version to update to"))),i().createElement(i().Fragment,null,i().createElement(s.Z,{historyProp:T,locationProp:j,className:"pf-u-mt-sm",apiFilterSort:!0,isUseApi:!0,loadTableData:p,filters:U,tableData:{count:null==d||null===(u=d.ImageInfo)||void 0===u?void 0:u.Count,isLoading:m,hasError:b},columnNames:C,rows:le,defaultSort:{index:0,direction:"desc"},hasRadio:!0,setRadioSelection:function(e){q(e.cells[0]),G(e)},isFooterFixed:!0}),i().createElement("div",{style:{background:"white",left:"200px",position:"fixed",height:"90px",width:"100%",bottom:"0px",paddingLeft:"80px",paddingBottom:"0px"}},i().createElement(h.i,{style:{paddingBottom:"25px",width:"100%",paddingLeft:0}}),i().createElement(v.zx,{style:{left:"60px"},key:"confirm",variant:"primary",isDisabled:!V||H,onClick:function(){return ne()}},"Update system"),i().createElement(v.zx,{style:{left:"70px"},key:"cancel",variant:"link",onClick:re},"Cancel")))))))};A.propTypes={data:d().oneOfType([d().object,d().array]),historyProp:d().func,locationProp:d().func,routeMatchProp:d().func,fetchDevices:d().func,isLoading:d().bool,hasError:d().bool};var R=function(e){var t,n,r,c,l=e.inventoryId,o=e.historyProp,s=e.locationProp,u=e.routeMatchProp,d=(0,N.useParams)(),v=d.deviceId,f=d.groupId,g=(0,Z.Z)({api:O.V3,id:l||v,tableReload:!0}),h=(0,a.Z)(g,2),E=h[0],y=E.data,w=E.isLoading,k=E.hasError,x=h[1],I=null==y?void 0:y.Device,L=f?null==I||null===(t=I.DevicesGroups)||void 0===t||null===(n=t.find((function(e){return e.ID.toString()===f})))||void 0===n?void 0:n.Name:null;return i().createElement(i().Fragment,null,i().createElement(T.Z,{className:"pf-m-light"},L?i().createElement(p.a,{ouiaId:"groups-list"},i().createElement(m.g,null,i().createElement(N.Link,{to:S._.fleetManagement},"Groups")),i().createElement(m.g,null,i().createElement(N.Link,{to:"".concat(S._.fleetManagement,"/").concat(f)},L||i().createElement(b.O,{width:"100px"}))),i().createElement(m.g,null,i().createElement(N.Link,{to:"".concat(S._.fleetManagement,"/").concat(f,"/systems/").concat(v,"/")},null==I?void 0:I.DeviceName)),i().createElement(m.g,null,"Update")):i().createElement(p.a,{ouiaId:"systems-list"},i().createElement(m.g,null,i().createElement(N.Link,{to:S._.inventory},"Systems")),i().createElement(m.g,null,i().createElement(N.Link,{to:"".concat(S._.inventory,"/").concat(v,"/")},(null==I?void 0:I.DeviceName)||i().createElement(b.O,{width:"100px"}))),i().createElement(m.g,null,"Update")),i().createElement(j.Z,{title:"Update"}),i().createElement(P.D,{className:"pf-u-mt-md"},null!=I&&I.DeviceName?i().createElement(D.x,null,"Update ",i().createElement("strong",null,null==I?void 0:I.DeviceName)," to a newer version of ",i().createElement("strong",null,null==y||null===(r=y.ImageInfo)||void 0===r||null===(c=r.Image)||void 0===c?void 0:c.Name)," by selecting a new version from the table below."):i().createElement(b.O,{width:"100px"}))),i().createElement("section",{className:"edge-devices pf-l-page__main-section pf-c-page__main-section"},i().createElement(A,{data:y,fetchDevices:x,isLoading:w,hasError:k,historyProp:o,locationProp:s,routeMatchProp:u})))};R.propTypes={historyProp:d().func,locationProp:d().func,routeMatchProp:d().func,inventoryId:d().string};const V=R},8027:(e,t,n)=>{"use strict";n.d(t,{$v:()=>i,EQ:()=>d,V3:()=>u,_v:()=>s});var r=n(15861),a=n(64687),c=n.n(a),l=n(66702),o=n(93454),i=function(e){var t=e.query,n=(0,l.Vs)(t);return o.instance.get("".concat(l.Ds,"/devices/devicesview?").concat(n))},s=function(e){return o.instance.get("".concat(l.Ds,"/devices/").concat(e))},u=function(e){var t=e.id,n=e.query,r=(0,l.Vs)(n);return o.instance.get("".concat(l.Ds,"/devices/").concat(t,"?").concat(r))},d=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.instance.post("".concat(l.Ds,"/updates"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},66702:(e,t,n)=>{"use strict";n.d(t,{$J:()=>l,DO:()=>a,Ds:()=>c,Vs:()=>o});var r=n(71002),a="/api/image-builder/v1",c="/api/edge/v1",l="/api/content-sources/v1",o=function(e){return void 0===e?"":Object.keys(e).reduce((function(t,n){var a=void 0;return"object"===(0,r.Z)(e[n])&&"number"==typeof e[n].length&&e[n].length>0&&(a=e[n].reduce((function(e,t){return""===e?"".concat(n,"=").concat(t):"".concat(e,"&").concat(n,"=").concat(t)}),"")),["string","number"].includes((0,r.Z)(e[n]))&&""!==e[n]&&(a="".concat(n,"=").concat(e[n])),void 0===a?t:""===t?"".concat(a):"".concat(t,"&").concat(a)}),"")}},96094:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(4942),a=n(15861),c=n(29439),l=n(64687),o=n.n(l),i=n(83215),s=n(92950),u=n(77760);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const m=function(e){var t,n=e.api,r=e.id,l=void 0===r?null:r,d=e.statusMessages,m=e.tableReload,v=void 0!==m&&m,f=(0,u.useDispatch)(),g=(0,s.useState)([]),h=(0,c.Z)(g,2),E=h[0],y=h[1],b=(0,s.useState)(!0),D=(0,c.Z)(b,2),P=D[0],w=D[1],O=(0,s.useState)(!1),k=(0,c.Z)(O,2),x=k[0],S=k[1],I=null===(t=d)||void 0===t?void 0:t.onSuccess;d||(d={onSuccess:{title:"Success",description:"The request has been made successfully"},onError:{title:"Error",description:"An error occurred making the request"}});var T=function(){var e=(0,a.Z)(o().mark((function e(){var t,r,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",w(!0),e.prev=2,e.next=5,n({id:l,query:t});case 5:r=e.sent,y(r),I&&f(p({},(0,i.wN)(p({variant:"success"},d.onSuccess)))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),S(!0),f(p({},(0,i.wN)(p({variant:"danger"},d.onError))));case 14:return e.prev=14,w(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,10,14,17]])})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){v||T()}),[]),[{data:E,isLoading:P,hasError:x},T]}},32349:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(4942),a=n(15861),c=n(64687),l=n.n(c),o=n(83215);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const u=function(e,t,n,r){var c,i,u=null===(c=n)||void 0===c?void 0:c.onSuccess,d=null===(i=n)||void 0===i?void 0:i.onInfo;n||(n={onSuccess:{title:"Success",description:"The request has been made successfully"},onError:{title:"Error",description:"An error occurred making the request"}});var p=function(){var c=(0,a.Z)(l().mark((function a(){var c;return l().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t();case 3:return c=a.sent,d&&(r?r.hasInfo(n.onInfo):e(s({},(0,o.wN)(s({variant:"info"},n.onInfo))))),u&&(r?r.hasSuccess(n.onSuccess):e(s({},(0,o.wN)(s({variant:"success"},n.onSuccess))))),a.abrupt("return",c);case 9:return a.prev=9,a.t0=a.catch(0),r?r.err(n.onError,a.t0):e(s({},(0,o.wN)(s(s({variant:"danger"},n.onError),{},{description:null!==a.t0&&void 0!==a.t0&&a.t0.Title?"".concat(n.onError.description,": ").concat(a.t0.Title):n.onError.description})))),a.abrupt("return",a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(){return c.apply(this,arguments)}}();return p()}},58392:()=>{},80598:()=>{},10108:()=>{},80897:()=>{},92084:()=>{}}]);
//# sourceMappingURL=../sourcemaps/2805.409cb609b0d11903c1903f24e2f94d04.js.map