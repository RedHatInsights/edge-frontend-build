"use strict";(self.webpackChunkedge_frontend=self.webpackChunkedge_frontend||[]).push([[5344,6681],{68940:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var a=n(4942),r=n(15861),i=n(29439),l=n(64687),o=n.n(l),c=n(92950),s=n.n(c),u=n(68774),d=n(68340),m=n(52643),p=n(29390),f=n(2372),v=n(24197),g=n(69957),b=n(45697),y=n.n(b),h=n(93597),w=n(8027),O=n(86706),E=n(83215),D=n(60722),j=n(96354),I=n(60485),S=n(78140),T=n(25834),P=function(e){var t=e.reviewObject,n=e.key;return s().createElement(u.D,null,s().createElement(I.D,{headingLevel:"h3"},s().createElement(d.x,{component:"b"},t.title)),s().createElement(T.G,{component:T.F.dl},t.rows.map((function(e){return s().createElement(c.Fragment,{key:e.title+n},s().createElement(S.T,{component:S.v.dt},e.title),s().createElement(S.T,{component:S.v.dd},e.value))}))))};P.propTypes={reviewObject:y().object,key:y().string};const _=P;var k=n(62410),N=n(98309);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(e){var t,n=e.updateModal,a=e.setUpdateModal,l=e.refreshTable,b=(0,c.useState)(null),y=(0,i.Z)(b,2),I=y[0],S=y[1],T=(0,O.I0)(),P=n.deviceData.length>1,U=n.deviceData.map((function(e){return e.id})),C=P?n.deviceData.map((function(e){return e.display_name})):null==n||null===(t=n.deviceData[0])||void 0===t?void 0:t.display_name;(0,c.useEffect)((function(){var e;null!=n&&n.imageSetId?(0,h.dt)({id:n.imageSetId,q:{limit:1,sort_by:"-created_at",status:"SUCCESS"}}).then((function(e){return S(e.Data.images[0])})):(e=n.imageId,(0,h.Kz)({id:e}).then((function(e){var t;return(0,h.dt)({id:null==e||null===(t=e.image)||void 0===t?void 0:t.ImageSetID,q:{limit:1,sort_by:"-created_at"}})}))).then((function(e){return S(e.Data.images[0])}))}),[]);var x=function(){var e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,w.EQ)({DevicesUUID:U});case 3:T(Z({},(0,E.wN)({variant:"info",title:"Updating system",description:P?" ".concat(C.length," systems were added to the queue."):" ".concat(C," was added to the queue.")}))),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),T(Z({},(0,E.wN)({variant:"danger",title:"Updating a system was unsuccessful",description:"Response: ".concat(e.t0.statusText)})));case 9:A(),l&&l();case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),A=function(){a((function(e){return Z(Z({},e),{},{isOpen:!1})}))},R={title:"Update to version ".concat(null==I?void 0:I.image.Version),rows:[{title:"Image Name",value:null==I?void 0:I.image.Name},{title:"Version",value:null==I?void 0:I.image.Version},{title:"Created",value:s().createElement(k.Z,{date:null==I?void 0:I.image.CreatedAt})},{title:"Release",value:N.aN[null==I?void 0:I.image.Distribution]}]},q={title:"Changes from version ".concat((null==I?void 0:I.image.Version)-1),rows:[{title:"Added",value:(null==I?void 0:I.update_added)||0},{title:"Removed",value:(null==I?void 0:I.update_removed)||0},{title:"Updated",value:(null==I?void 0:I.update_updated)||0}]},L={fields:[{component:j.Z.PLAIN_TEXT,name:"description",label:s().createElement(u.D,null,s().createElement(d.x,null,"Update"," ",s().createElement("span",{className:"pf-u-font-weight-bold pf-u-font-size-md"},P?"".concat(C.length," systems"):C)," ","to latest version of the image linked to it."),n.deviceData.some((function(e){return"updateAvailable"!==e.deviceStatus&&"error"!==e.deviceStatus}))&&s().createElement(v.b,{variant:"info",isInline:!0,title:"Some systems will not be updated. This action will update only systems with an update available.",style:{"--pf-c-content--h4--MarginTop":0}}))},{component:j.Z.PLAIN_TEXT,name:"update-details",label:_({reviewObject:R,key:"update-details"})},{component:j.Z.PLAIN_TEXT,name:"package-details",label:_({reviewObject:q,key:"package-details"})},{component:j.Z.PLAIN_TEXT,name:"warning-text",label:s().createElement(u.D,{className:"pf-u-pt-md"},s().createElement(d.x,{style:{color:"var(--pf-global--warning-color--200"},component:"small"},s().createElement(g.ZP,{style:{color:"var(--pf-global--warning-color--100"}})," ","After the update is installed, the system will apply the changes."))}]};return s().createElement(s().Fragment,null,I?s().createElement(D.Z,{size:"medium",title:"Update system".concat(P?"s":""," to latest image version"),isOpen:n.isOpen,closeModal:function(){return a((function(e){return Z(Z({},e),{},{isOpen:!1})}))},submitLabel:"Update system",schema:L,onSubmit:x,reloadData:l}):s().createElement(p.Y,null,s().createElement(m.b,null,s().createElement(f.$,{isSVG:!0,diameter:"100px"}))))};C.propTypes={refreshTable:y().func,updateModal:y().shape({isOpen:y().bool.isRequired,deviceData:y().array.isRequired,imageData:y().object,imageId:y().number,imageSetId:y().number}).isRequired,setUpdateModal:y().func.isRequired};const x=C},49477:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var a=n(4942),r=n(15861),i=n(29439),l=n(64687),o=n.n(l),c=n(92950),s=n.n(c),u=n(69185),d=n(96354),m=n(52251),p=n(2372),f=n(45697),v=n.n(f),g=n(20873),b=n(94778),y=n(86706),h=n(83215),w=n(93597),O=n(48903),E=n(98309);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){var t=e.navigateBack,n=e.reload,a=(0,c.useState)(),l=(0,i.Z)(a,2),f=l[0],v=l[1],D=(0,y.I0)(),I=(0,O.gV)("fleet-management.temporary-releases"),S=function(){t(),n&&n()};(0,c.useEffect)((function(){(0,r.Z)(o().mark((function e(){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(a=n.auth)||void 0===a||a.getUser().then((function(e){return v(null!=e?e:{})}));case 1:case"end":return e.stop()}}),e)})))()}),[]);var T=(0,m.tW)();return f?s().createElement(u.Z,{onClose:S,customComponentMapper:{review:g.Z},onSubmit:function(e){var t=e.values;(0,e.setIsSaving)((function(){return!0}));var n=j(j({},t),{},{architecture:"x86_64"});(0,b.Es)(D,n,(function(e){D(j(j({},(0,h.wN)({variant:"info",title:"Created image",description:"".concat(e.value.Name," image was added to the queue.")})),{},{meta:{polling:{id:"FETCH_IMAGE_".concat(e.value.ID,"_BUILD_STATUS"),fetcher:function(){return(0,w.EC)(e.value.ID)},condition:function(e){switch(e.Status){case"BUILDING":return[!0,""];case"ERROR":return[!1,"failure"];default:return[!1,"success"]}},onEvent:{failure:[function(t){return t((0,h.wN)({variant:"danger",title:"Image build failed",description:"".concat(e.value.Name," image build is completed unsuccessfully")}))}],success:[function(t){return t((0,h.wN)({variant:"success",title:"Image is ready",description:"".concat(e.value.Name," image build is completed")}))}]}}}})),S()}))},defaultArch:"x86_64",initialValues:{version:0,release:I?E.ml:E.az},schema:{fields:[{component:d.Z.WIZARD,name:"image-builder-wizard",className:"image-builder",isDynamic:!0,inModal:!0,buttonLabels:{submit:"Create image"},showTitles:!0,title:"Create image",crossroads:["release","imageType","third-party-repositories","imageOutput"],fields:[T,m.Ud,m.l9,m.jS,m.B9,m.j7,m.Sp]}]}}):s().createElement(p.$,null)};I.propTypes={navigateBack:v().func,reload:v().func},I.defaultProps={navigateBack:function(){}};const S=I}}]);
//# sourceMappingURL=../sourcemaps/CreateImageWizard.6b501d3d19fd9bde09c56191e5c65770.js.map