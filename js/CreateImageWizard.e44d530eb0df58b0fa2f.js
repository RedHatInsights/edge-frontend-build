"use strict";(self.webpackChunkinsights_frontend_starter_app=self.webpackChunkinsights_frontend_starter_app||[]).push([[344],{79358:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var a=n(4942),r=n(15861),i=n(87757),o=n.n(i),c=n(93264),l=n.n(c),s=n(80236),d=n(47173),u=n(68340),p=n(68774),m=n(78140),v=n(25834),f=n(69957),g=n(62410),b=n(68920),h=n(45697),E=n.n(h),y=n(66702),O=n(82041),D=n(83215);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){var t,n,a,i,c,h,E,w,j,k,I,P,U,_,C,x=e.updateModal,N=e.setUpdateModal,Z=e.refreshTable,R=(0,O.useDispatch)(),A=null===(t=x.deviceData)||void 0===t||null===(n=t.system_profile)||void 0===n||null===(a=n.image_data)||void 0===a||null===(i=a.ImageInfo)||void 0===i?void 0:i.UpdatesAvailable[(null===(c=x.deviceData)||void 0===c||null===(h=c.system_profile)||void 0===h||null===(E=h.image_data)||void 0===E||null===(w=E.ImageInfo)||void 0===w?void 0:w.UpdatesAvailable.length)-1],S=function(){var e=(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.g5)({DeviceUUID:null===(t=x.deviceData)||void 0===t?void 0:t.id,CommitId:null==A?void 0:A.Image.CommitID});case 3:R(T({},(0,D.wN)({variant:"info",title:"Updating device",description:" ".concat(x.deviceData.display_name," was added to the queue.")}))),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),R(T({},(0,D.wN)({variant:"danger",title:"Updating a device was unsuccessful",description:"Response: ".concat(e.t0.statusText)})));case 9:q(),Z();case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),q=function(){N((function(e){return T(T({},e),{},{isOpen:!1})}))};return l().createElement(s.u,{variant:"medium",title:"Update ".concat(null===(j=x.deviceData)||void 0===j?void 0:j.display_name," to latest image"),description:"Update this device to use the latest version of the image linked to it.",isOpen:x.isOpen,onClose:q,actions:[l().createElement(d.zx,{key:"confirm",variant:"primary",onClick:S},"Update Device"),l().createElement(d.zx,{key:"cancel",variant:"link",onClick:q},"Cancel")]},l().createElement(p.D,null,l().createElement(m.T,{component:u.q.h3},l().createElement(u.x,{component:"b"},"Update to")),l().createElement(v.G,{component:v.F.dl},l().createElement(m.T,{component:m.v.dt},"Image Name"),l().createElement(m.T,{component:m.v.dd},null==A?void 0:A.Image.Name),l().createElement(m.T,{component:m.v.dt},"Version"),l().createElement(m.T,{component:m.v.dd},null==A?void 0:A.Image.Version),l().createElement(m.T,{component:m.v.dt},"Created"),l().createElement(m.T,{component:m.v.dd},l().createElement(g.Z,{date:null==A?void 0:A.Image.CreatedAt})),l().createElement(m.T,{component:m.v.dt},"Release"),l().createElement(m.T,{component:m.v.dd},b.aN[null==A?void 0:A.Image.Distribution])),l().createElement(m.T,{component:u.q.h3},l().createElement(u.x,{component:"b"},"Package Details")),l().createElement(v.G,{component:v.F.dl},l().createElement(m.T,{component:m.v.dt},"Added"),l().createElement(m.T,{component:m.v.dd},(null==A||null===(k=A.PackageDiff)||void 0===k||null===(I=k.Added)||void 0===I?void 0:I.length)||0),l().createElement(m.T,{component:m.v.dt},"Removed"),l().createElement(m.T,{component:m.v.dd},(null==A||null===(P=A.PackageDiff)||void 0===P||null===(U=P.Removed)||void 0===U?void 0:U.length)||0),l().createElement(m.T,{component:m.v.dt},"Updated"),l().createElement(m.T,{component:m.v.dd},(null==A||null===(_=A.PackageDiff)||void 0===_||null===(C=_.Updated)||void 0===C?void 0:C.length)||0))),l().createElement(p.D,{className:"pf-u-pt-md"},l().createElement(u.x,{style:{color:"var(--pf-global--palette--gold-500)"},component:"small"},l().createElement(f.ZP,null)," After the update is installed, the device will apply the changes.")))};j.propTypes={refreshTable:E().func,updateModal:E().shape({isOpen:E().bool.isRequired,deviceData:E().object.isRequired}).isRequired,setUpdateModal:E().func.isRequired};const k=j},49477:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var a=n(4942),r=n(15861),i=n(29439),o=n(87757),c=n.n(o),l=n(93264),s=n.n(l),d=n(67098),u=n(96354),p=n(1005),m=n(2372),v=n(45697),f=n.n(v),g=n(20873),b=n(94778),h=n(59086),E=n(82041),y=n(83215),O=n(66702);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t=e.navigateBack,n=(0,l.useState)(),a=(0,i.Z)(n,2),o=a[0],v=a[1],f=(0,E.useDispatch)(),D=function(){t(),f({type:h.G})};return(0,l.useEffect)((function(){(0,r.Z)(c().mark((function e(){var t,n,a,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(a=n.auth)||void 0===a?void 0:a.getUser();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:r=e.t0,v((function(){return r}));case 7:case"end":return e.stop()}}),e)})))()}),[]),o?s().createElement(d.Z,{onClose:D,customComponentMapper:{review:g.Z},onSubmit:function(e){var t=e.values;(0,e.setIsSaving)((function(){return!0}));var n=w(w({},t),{},{architecture:"x86_64"});(0,b.Es)(f,n,(function(e){f(w(w({},(0,y.wN)({variant:"info",title:"Created image",description:"".concat(e.value.Name," image was added to the queue.")})),{},{meta:{polling:{id:"FETCH_IMAGE_".concat(e.value.ID,"_BUILD_STATUS"),fetcher:function(){return(0,O.EC)(e.value.ID)},condition:function(e){switch(e.Status){case"BUILDING":return[!0,""];case"ERROR":return[!1,"failure"];default:return[!1,"success"]}},onEvent:{failure:[function(t){return t((0,y.wN)({variant:"danger",title:"Image build failed",description:"".concat(e.value.Name," image build is completed unsuccessfully")}))}],success:[function(t){return t((0,y.wN)({variant:"success",title:"Image is ready",description:"".concat(e.value.Name," image build is completed")}))},function(e){return(0,b.Z5)(e)}]}}}})),D(),(0,b.Z5)(f)}))},defaultArch:"x86_64",initialValues:{version:0},schema:{fields:[{component:u.Z.WIZARD,name:"image-builder-wizard",className:"image-builder",isDynamic:!0,inModal:!0,buttonLabels:{submit:"Create image"},showTitles:!0,title:"Create image",crossroads:["target-environment","release","imageType"],fields:[p.oG,p.Ud,p.l9,p.B9,p.j7]}]}}):s().createElement(m.$,null)};T.propTypes={navigateBack:f().func},T.defaultProps={navigateBack:function(){}};const j=T}}]);
//# sourceMappingURL=../sourcemaps/CreateImageWizard.331063fed058367bcc327c8631f93fe0.js.map