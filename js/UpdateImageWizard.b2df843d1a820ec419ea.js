"use strict";(self.webpackChunkinsights_frontend_starter_app=self.webpackChunkinsights_frontend_starter_app||[]).push([[46],{53010:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var a=n(4942),r=n(15861),i=n(29439),u=n(87757),s=n.n(u),l=n(93264),c=n.n(l),o=n(67098),d=n(96354),m=n(1005),f=n(2372),p=n(45697),v=n.n(p),g=n(20873),b=n(94778),h=n(59086),y=n(82041),I=n(59245),D=n(96667),w=n(66702),O=n(83215);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(e){var t=e.navigateBack,n=e.updateImageID,a=(0,l.useState)(),u=(0,i.Z)(a,2),p=u[0],v=u[1],j=(0,y.useDispatch)(),N=function(){t(),j({type:h.G})},_=(0,l.useContext)(I.g).getRegistry,k=(0,y.useSelector)((function(e){var t=e.imageDetailReducer;return{data:(null==t?void 0:t.data)||null}}),y.shallowEqual).data;return(0,l.useEffect)((function(){var e=_().register({imageDetailReducer:D.OD});return(0,b.J_)(j,n),function(){return e()}}),[j]),(0,l.useEffect)((function(){(0,r.Z)(s().mark((function e(){var t,n,a,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(a=n.auth)||void 0===a?void 0:a.getUser();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:r=e.t0,v((function(){return r}));case 7:case"end":return e.stop()}}),e)})))()}),[]),p?c().createElement(o.Z,{onClose:N,customComponentMapper:{review:g.Z},onSubmit:function(e){var t=e.values;(0,e.setIsSaving)((function(){return!0}));var n=E(E({},t),{},{Id:null==k?void 0:k.ID,name:null==k?void 0:k.Name,version:(null==k?void 0:k.Version)+1,architecture:"x86_64",credentials:t.credentials?t.credentials:null==k?void 0:k.Installer.SshKey,username:t.username?t.username:null==k?void 0:k.Installer.Username});(0,b.Es)(j,n,(function(e){j(E(E({},(0,O.wN)({variant:"info",title:"Update image",description:"".concat(e.value.Name," image was added to the queue.")})),{},{meta:{polling:{id:"FETCH_IMAGE_".concat(e.value.ID,"_BUILD_STATUS"),fetcher:function(){return(0,w.EC)(e.value.ID)},condition:function(e){switch(e.Status){case"BUILDING":return[!0,""];case"ERROR":return[!1,"failure"];default:return[!1,"success"]}},onEvent:{failure:[function(t){return t((0,O.wN)({variant:"danger",title:"Image build failed",description:"".concat(e.value.Name," image build is completed unsuccessfully")}))}],success:[function(t){return t((0,O.wN)({variant:"success",title:"Image is ready",description:"".concat(e.value.Name," image build is completed")}))},function(e){return(0,b.Z5)(e)}]}}}})),N(),(0,b.Z5)(j),j((0,b.Fj)({name:k.value.Name,id:k.value.ID}))}))},defaultArch:"x86_64",initialValues:{name:null==k?void 0:k.Name,isUpdate:!0,description:null==k?void 0:k.Description,credentials:null==k?void 0:k.Installer.SshKey,username:null==k?void 0:k.Installer.Username,version:null==k?void 0:k.Version,release:null==k?void 0:k.Distribution,imageType:["rhel-edge-commit"],"selected-packages":null==k?void 0:k.Packages.map((function(e){return E(E({},e),{},{name:e.Name})}))},schema:{fields:[{component:d.Z.WIZARD,name:"image-builder-wizard",className:"image-builder",isDynamic:!0,inModal:!0,buttonLabels:{submit:"Create image"},showTitles:!0,title:"Update image: ".concat(null==k?void 0:k.Name),crossroads:["target-environment","release","imageType"],fields:[m.bR,m.Ud,m.l9,m.B9,m.j7]}]}}):c().createElement(f.$,null)};N.propTypes={navigateBack:v().func,updateImageID:v().number},N.defaultProps={navigateBack:function(){}};const _=N}}]);
//# sourceMappingURL=../sourcemaps/UpdateImageWizard.bd537671ecec9673b352f7f5377ed4d2.js.map