(self.webpackChunkedge_frontend=self.webpackChunkedge_frontend||[]).push([[2805],{66581:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>q});var r=n(15861),a=n(29439),l=n(64687),c=n.n(l),o=n(92950),i=n.n(o),s=n(73448),u=n(45697),d=n.n(u),p=n(64029),m=n(32835),v=n(47173),f=n(32203),g=n(62394),h=n(15627),y=n(16488),E=n(32045),b=n(50383),D=n(68340),k=n(68774),O=n(38779),P=n(8027),w=n(98309),x=n(77760),T=n(9192),S=n(62410),I=n(89376),j=n(39173),Z=n(96094),N=n(34766),U=n(68519),_=n(32349),L=n(48903),C=[{label:"Version",type:"text"},{label:"Release",type:"text"},{label:"Additional packages",type:"text"},{label:"All packages",type:"text"},{label:"Systems running",type:"text"},{label:"Created",type:"text"}],M=[{title:"Version",cellTransforms:[(0,N.headerCol)("selectable-radio")]},{title:"Release"},{title:"Additional packages"},{title:"All packages"},{title:"Systems running"},{title:"Created"}],A=function(e){var t=e.image,n=[{version:t.cells[0],release:t.cells[1],additionalPackages:t.cells[2],allPackages:t.cells[3],systemsRunning:t.cells[4],created:t.cells[5]}],r="Version",a="Release",l="Additional packages",c="All packages",o="Systems running",s="Created";return i().createElement(i().Fragment,null,i().createElement(k.D,null,i().createElement(O.D,{headingLevel:"h2"},i().createElement(D.x,null,"Current version"))),i().createElement(N.TableComposable,{"aria-label":"Current version table",variant:"compact",borders:!1},i().createElement(N.Thead,null,i().createElement(N.Tr,{style:{borderBottomStyle:"hidden"}},i().createElement(N.Th,{style:{width:"3%"}}),i().createElement(N.Th,null,r),i().createElement(N.Th,null,a),i().createElement(N.Th,null,l),i().createElement(N.Th,null,c),i().createElement(N.Th,null,o),i().createElement(N.Th,null,s))),i().createElement(N.Tbody,null,n.map((function(e,t){return i().createElement(N.Tr,{key:t},i().createElement(N.Td,null),i().createElement(N.Td,{dataLabel:r},e.version),i().createElement(N.Td,{dataLabel:a},e.release),i().createElement(N.Td,{dataLabel:l},e.additionalPackages),i().createElement(N.Td,{dataLabel:c},e.allPackages),i().createElement(N.Td,{dataLabel:o},e.systemsRunning),i().createElement(N.Td,{dataLabel:s},e.created))})))))};A.propTypes={image:d().object};var R=function(e){var t,n,l,u,d=e.data,p=e.fetchDevices,m=e.isLoading,b=e.hasError,I=e.historyProp,j=e.locationProp,Z=e.routeMatchProp,N=null==d?void 0:d.Device,L=(0,o.useState)(null),R=(0,a.Z)(L,2),V=R[0],q=R[1],F=(0,o.useState)(null),W=(0,a.Z)(F,2),B=W[0],$=W[1],z=(0,o.useState)(!1),G=(0,a.Z)(z,2),Q=G[0],H=G[1],J=(0,x.useDispatch)(),K=I?I():U.k6?(0,U.k6)():null,X=j?j():(0,U.TH)(),Y=X.pathname,ee=X.search,te=Z?Z():(0,U.$B)(),ne=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),t={onInfo:{title:"Updating system",description:" ".concat(B.deviceName," was added to the queue.")},onError:{title:"Error",description:"Failed to update the selected system(s)"}},e.next=4,(0,_.Z)(J,(function(){return(0,P.EQ)({CommitID:B.commitID,DevicesUUID:[B.deviceUUID]})}),t);case 4:re(),H(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=T._.inventory;te.path===T._.inventoryDetailUpdate&&(e=ee.includes("from_details=true")?T._.inventoryDetail:T._.inventory),te.path===T._.fleetManagementSystemDetailUpdate&&(e=ee.includes("from_details=true")?T._.fleetManagementSystemDetail:T._.fleetManagementDetail);var t=e.split("/").length,n=Y.split("/").slice(0,t).join("/");K.push({pathname:n})},ae=function(e){var t,n=null==e?void 0:e.Version;return{cells:[n,w.aN[null==e?void 0:e.Distribution],(null==e||null===(t=e.Packages)||void 0===t?void 0:t.length)||0,null==e?void 0:e.TotalPackages,null==e?void 0:e.SystemsRunning,i().createElement("span",null,i().createElement(S.Z,{type:"relative",date:null==e?void 0:e.CreatedAt}))],commitID:null==e?void 0:e.CommitID,deviceUUID:null==N?void 0:N.UUID,deviceName:null==N?void 0:N.DeviceName,selected:V===n}},le=ae(null==d||null===(t=d.ImageInfo)||void 0===t?void 0:t.Image),ce=null==d||null===(n=d.ImageInfo)||void 0===n||null===(l=n.UpdatesAvailable)||void 0===l?void 0:l.map((function(e){return ae(null==e?void 0:e.Image)}));return i().createElement(y.T,null,i().createElement(E.NP,{isWidthLimited:!0},i().createElement(f.Z,null,i().createElement(g.e,null,i().createElement(A,{image:le}),i().createElement(k.D,null,i().createElement(O.D,{headingLevel:"h2"},i().createElement(D.x,{className:"pf-u-mt-md"},"Select version to update to"))),i().createElement(i().Fragment,null,i().createElement(s.Z,{historyProp:I,locationProp:j,className:"pf-u-mt-sm",apiFilterSort:!0,isUseApi:!0,loadTableData:p,filters:C,tableData:{count:null==d||null===(u=d.ImageInfo)||void 0===u?void 0:u.Count,isLoading:m,hasError:b},columnNames:M,rows:ce,defaultSort:{index:0,direction:"desc"},hasRadio:!0,setRadioSelection:function(e){q(e.cells[0]),$(e)},isFooterFixed:!0}),i().createElement("div",{style:{background:"white",left:"200px",position:"fixed",height:"90px",width:"100%",bottom:"0px",paddingLeft:"80px",paddingBottom:"0px"}},i().createElement(h.i,{style:{paddingBottom:"25px",width:"100%",paddingLeft:0}}),i().createElement(v.zx,{style:{left:"60px"},key:"confirm",variant:"primary",isDisabled:!V||Q,onClick:function(){return ne()}},"Update system"),i().createElement(v.zx,{style:{left:"70px"},key:"cancel",variant:"link",onClick:re},"Cancel")))))))};R.propTypes={data:d().oneOfType([d().object,d().array]),historyProp:d().func,locationProp:d().func,routeMatchProp:d().func,fetchDevices:d().func,isLoading:d().bool,hasError:d().bool};var V=function(e){var t,n,r,l,c=e.inventoryId,o=e.historyProp,s=e.locationProp,u=e.routeMatchProp,d=e.paramsProp,v=o?o():U.k6?(0,U.k6)():null,f=d?d():U.UO?(0,U.UO)():null,g=f.deviceId,h=f.groupId,y=c||g,E=o?"/edge":T._.inventory,O=(0,Z.Z)({api:P.V3,id:y,tableReload:!0}),w=(0,a.Z)(O,2),x=w[0],S=x.data,N=x.isLoading,_=x.hasError,C=w[1],M=null==S?void 0:S.Device,A=h?null==M||null===(t=M.DevicesGroups)||void 0===t||null===(n=t.find((function(e){return e.ID.toString()===h})))||void 0===n?void 0:n.Name:null;return i().createElement(i().Fragment,null,i().createElement(I.Z,{className:"pf-m-light"},A?i().createElement(p.a,{ouiaId:"groups-list"},i().createElement(m.g,null,(0,L.EW)({pathname:T._.fleetManagement,linkText:"Groups",history:v})),i().createElement(m.g,null,(0,L.EW)({pathname:"".concat(T._.fleetManagement,"/").concat(h),linkText:A||i().createElement(b.O,{width:"100px"}),history:v})),i().createElement(m.g,null,(0,L.EW)({pathname:"".concat(T._.fleetManagement,"/").concat(h,"/systems/").concat(y,"/"),linkText:null==M?void 0:M.DeviceName,history:v})),i().createElement(m.g,null,"Update")):i().createElement(p.a,{ouiaId:"systems-list"},i().createElement(m.g,null,(0,L.EW)({pathname:"/edge"===E?"/":E,linkText:"Systems",history:v})),i().createElement(m.g,null,(0,L.EW)({pathname:"".concat(E,"/").concat(y,"/"),linkText:(null==M?void 0:M.DeviceName)||i().createElement(b.O,{width:"100px"}),history:v})),i().createElement(m.g,null,"Update")),i().createElement(j.Z,{title:"Update"}),i().createElement(k.D,{className:"pf-u-mt-md"},null!=M&&M.DeviceName?i().createElement(D.x,null,"Update ",i().createElement("strong",null,null==M?void 0:M.DeviceName)," to a newer version of ",i().createElement("strong",null,null==S||null===(r=S.ImageInfo)||void 0===r||null===(l=r.Image)||void 0===l?void 0:l.Name)," by selecting a new version from the table below."):i().createElement(b.O,{width:"100px"}))),i().createElement("section",{className:"edge-devices pf-l-page__main-section pf-c-page__main-section"},i().createElement(R,{data:S,fetchDevices:C,isLoading:N,hasError:_,historyProp:o,locationProp:s,routeMatchProp:u})))};V.propTypes={historyProp:d().func,locationProp:d().func,routeMatchProp:d().func,paramsProp:d().func,inventoryId:d().string};const q=V},8027:(e,t,n)=>{"use strict";n.d(t,{$v:()=>i,EQ:()=>d,V3:()=>u,_v:()=>s});var r=n(15861),a=n(64687),l=n.n(a),c=n(66702),o=n(93454),i=function(e){var t=e.query,n=(0,c.Vs)(t);return o.instance.get("".concat(c.Ds,"/devices/devicesview?").concat(n))},s=function(e){return o.instance.get("".concat(c.Ds,"/devices/").concat(e))},u=function(e){var t=e.id,n=e.query,r=(0,c.Vs)(n);return o.instance.get("".concat(c.Ds,"/devices/").concat(t,"?").concat(r))},d=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.instance.post("".concat(c.Ds,"/updates"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},66702:(e,t,n)=>{"use strict";n.d(t,{$J:()=>c,DO:()=>a,Ds:()=>l,Vs:()=>o});var r=n(71002),a="/api/image-builder/v1",l="/api/edge/v1",c="/api/content-sources/v1",o=function(e){return void 0===e?"":Object.keys(e).reduce((function(t,n){var a=void 0;return"object"===(0,r.Z)(e[n])&&"number"==typeof e[n].length&&e[n].length>0&&(a=e[n].reduce((function(e,t){return""===e?"".concat(n,"=").concat(t):"".concat(e,"&").concat(n,"=").concat(t)}),"")),["string","number"].includes((0,r.Z)(e[n]))&&""!==e[n]&&(a="".concat(n,"=").concat(e[n])),void 0===a?t:""===t?"".concat(a):"".concat(t,"&").concat(a)}),"")}},96094:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(4942),a=n(15861),l=n(29439),c=n(64687),o=n.n(c),i=n(83215),s=n(92950),u=n(77760);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const m=function(e){var t,n=e.api,r=e.id,c=void 0===r?null:r,d=e.statusMessages,m=e.tableReload,v=void 0!==m&&m,f=(0,u.useDispatch)(),g=(0,s.useState)([]),h=(0,l.Z)(g,2),y=h[0],E=h[1],b=(0,s.useState)(!0),D=(0,l.Z)(b,2),k=D[0],O=D[1],P=(0,s.useState)(!1),w=(0,l.Z)(P,2),x=w[0],T=w[1],S=null===(t=d)||void 0===t?void 0:t.onSuccess;d||(d={onSuccess:{title:"Success",description:"The request has been made successfully"},onError:{title:"Error",description:"An error occurred making the request"}});var I=function(){var e=(0,a.Z)(o().mark((function e(){var t,r,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",O(!0),e.prev=2,e.next=5,n({id:c,query:t});case 5:r=e.sent,E(r),S&&f(p({},(0,i.wN)(p({variant:"success"},d.onSuccess)))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),T(!0),f(p({},(0,i.wN)(p({variant:"danger"},d.onError))));case 14:return e.prev=14,O(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,10,14,17]])})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){v||I()}),[]),[{data:y,isLoading:k,hasError:x},I]}},32349:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(4942),a=n(15861),l=n(64687),c=n.n(l),o=n(83215);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const u=function(e,t,n,r){var l,i,u=null===(l=n)||void 0===l?void 0:l.onSuccess,d=null===(i=n)||void 0===i?void 0:i.onInfo;n||(n={onSuccess:{title:"Success",description:"The request has been made successfully"},onError:{title:"Error",description:"An error occurred making the request"}});var p=function(){var l=(0,a.Z)(c().mark((function a(){var l;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t();case 3:return l=a.sent,d&&(r?r.hasInfo(n.onInfo):e(s({},(0,o.wN)(s({variant:"info"},n.onInfo))))),u&&(r?r.hasSuccess(n.onSuccess):e(s({},(0,o.wN)(s({variant:"success"},n.onSuccess))))),a.abrupt("return",l);case 9:return a.prev=9,a.t0=a.catch(0),r?r.err(n.onError,a.t0):e(s({},(0,o.wN)(s(s({variant:"danger"},n.onError),{},{description:null!==a.t0&&void 0!==a.t0&&a.t0.Title?"".concat(n.onError.description,": ").concat(a.t0.Title):n.onError.description})))),a.abrupt("return",a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(){return l.apply(this,arguments)}}();return p()}},58392:()=>{},80598:()=>{},10108:()=>{},80897:()=>{},92084:()=>{}}]);
//# sourceMappingURL=../sourcemaps/2805.21d7533c3d391dda4761bf44bf8034ec.js.map