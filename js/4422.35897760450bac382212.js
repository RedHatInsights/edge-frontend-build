(self.webpackChunkedge=self.webpackChunkedge||[]).push([[4422],{63767:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var r=n(74848),a=n(93345),i=n.n(a),o=n(59304),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},l=36e5,u=24*l,c=30*u,d=365*u,p=function(e,t){return"".concat(e," ").concat(e>1?"".concat(t,"s"):t," ago")},m=[{rightBound:1/0,description:function(e){return p(Math.round(e/d),"year")}},{rightBound:d,description:function(e){return p(Math.round(e/c),"month")}},{rightBound:c,description:function(e){return p(Math.round(e/u),"day")}},{rightBound:u,description:function(e){return p(Math.round(e/l),"hour")}},{rightBound:l,description:function(e){return p(Math.round(e/6e4),"minute")}},{rightBound:6e4,description:function(){return"Just now"}}],f=function(e){return e.toUTCString().split(",")[1].slice(0,-7).trim()},v=function(e){return{exact:function(e){return f(e)+" UTC"},onlyDate:function(e){return f(e).slice(0,-6)},relative:function(e){return m.reduce((function(t,n){return n.rightBound>Date.now()-e.getTime()?n.description(Date.now()-e.getTime()):t}),f(e))},invalid:function(){return"Invalid date"}}[e]},y=function(e,t,n){return{exact:function(t){return v(e)(t)},onlyDate:function(t){return v(e)(t)},relative:function(a){return function(e,t,n,a){return void 0===a&&(a=""),(0,r.jsx)(o.Tooltip,s({},n,{content:(0,r.jsxs)("div",{children:[a,e]}),children:t}))}(v("exact")(a),(0,r.jsx)("span",{children:v(e)(a)}),t,n)},invalid:function(){return"Invalid date"}}[e]};const b=function(e){var t=e.date,n=e.type,a=void 0===n?"relative":n,o=e.extraTitle,s=e.tooltipProps,l=t instanceof Date?t:new Date(t),u=null==t||"Invalid Date"===l.toString()?"invalid":a;return(0,r.jsx)(i().Fragment,{children:y(u,s,o)(l)})}},16547:(e,t,n)=>{var r=n(43360),a=n(75288),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var o=e[t];i.call(e,t)&&a(o,n)&&(void 0!==n||t in e)||r(e,t,n)}},39344:(e,t,n)=>{var r=n(23805),a=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(a)return a(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},72903:(e,t,n)=>{var r=n(23805),a=n(55527),i=n(90181),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=a(e),n=[];for(var s in e)("constructor"!=s||!t&&o.call(e,s))&&n.push(s);return n}},49653:(e,t,n)=>{var r=n(37828);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},93290:(e,t,n)=>{e=n.nmd(e);var r=n(9325),a=t&&!t.nodeType&&t,i=a&&e&&!e.nodeType&&e,o=i&&i.exports===a?r.Buffer:void 0,s=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}},71961:(e,t,n)=>{var r=n(49653);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},23007:e=>{e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},21791:(e,t,n)=>{var r=n(16547),a=n(43360);e.exports=function(e,t,n,i){var o=!n;n||(n={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=i?i(n[u],e[u],u,n,e):void 0;void 0===c&&(c=e[u]),o?a(n,u,c):r(n,u,c)}return n}},28879:(e,t,n)=>{var r=n(74335)(Object.getPrototypeOf,Object);e.exports=r},35529:(e,t,n)=>{var r=n(39344),a=n(28879),i=n(55527);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(a(e))}},90181:e=>{e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},2404:(e,t,n)=>{var r=n(60270);e.exports=function(e,t){return r(e,t)}},37241:(e,t,n)=>{var r=n(70695),a=n(72903),i=n(64894);e.exports=function(e){return i(e)?r(e,!0):a(e)}},27729:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>j});var r=n(93345),a=n.n(r),i=n(55729),o=n(11879),s=n(76959),l=n(80475),u=n(57179),c=n(73262),d=n.n(c),p=n(5556),m=n.n(p),f=n(66171),v=n(60732),y=n(36870),b=n(11830),g=n(59409),h=n(57502),w=n(76459);const A=({reviewObject:e,key:t})=>a().createElement(i.TextContent,null,a().createElement(w.Title,{headingLevel:"h3"},a().createElement(i.Text,{component:"b"},e.title)),a().createElement(i.TextList,{component:i.TextListVariants.dl},e.rows.map((e=>a().createElement(r.Fragment,{key:e.title+t},a().createElement(i.TextListItem,{component:i.TextListItemVariants.dt},e.title),a().createElement(i.TextListItem,{component:i.TextListItemVariants.dd},e.value))))));A.propTypes={reviewObject:m().object,key:m().string};const T=A;var x=n(63767),E=n(88993),I=n(55270);const O=({inventoryGroupUpdateDevicesInfo:e,updateModal:t,setUpdateModal:n,refreshTable:c,notificationProp:p})=>{if(e&&!e.update_valid)return void n((e=>({...e,isOpen:!1})));const[m,w]=(0,r.useState)(null),A=(0,y.wA)(),O=e?e.update_devices_uuids:t.deviceData.map((e=>e.id)),j=O.length>1;let _;_=e?e.update_devices_uuids:j?t.deviceData.map((e=>e.display_name)):t?.deviceData[0]?.display_name;const D=e?e.image_set_id:t?.imageSetId;(0,r.useEffect)((()=>{var e;D?(0,f.MH)({id:D,q:{limit:1,sort_by:"-created_at",status:"SUCCESS"}}).then((e=>w(e.Data.images[0]))):(e=t.imageId,(0,f.iI)({id:e}).then((e=>(0,f.MH)({id:e?.image?.ImageSetID,q:{limit:1,sort_by:"-created_at"}})))).then((e=>w(e.Data.images[0])))}),[]);const M={onInfo:{title:"Updating system",description:j?` ${_.length} systems were added to the queue.`:` ${_||"one system"}  was added to the queue.`},onError:{title:"Error",description:"Failed to update the selected system(s)"}},S={title:`Update to version ${m?.image.Version}`,rows:[{title:"Image Name",value:m?.image.Name},{title:"Version",value:m?.image.Version},{title:"Created",value:a().createElement(x.A,{date:m?.image.CreatedAt})},{title:"Release",value:E.WT[m?.image.Distribution]}]},U={title:"Changes from version "+(m?.image.Version-1),rows:[{title:"Added",value:m?.update_added||0},{title:"Removed",value:m?.update_removed||0},{title:"Updated",value:m?.update_updated||0}]},L={fields:[{component:h.A.PLAIN_TEXT,name:"description",label:a().createElement(i.TextContent,null,a().createElement(i.Text,null,"Update"," ",a().createElement("span",{className:"pf-u-font-weight-bold pf-u-font-size-md"},j?`${_.length} systems`:e||!_?"one system":_)," ","to latest version of the image linked to it."),t?.deviceData?.some((e=>"updateAvailable"!==e.deviceStatus&&"error"!==e.deviceStatus))&&a().createElement(u.Alert,{variant:"info",isInline:!0,title:"Some systems will not be updated. This action will update only systems with an update available.",style:{"--pf-c-content--h4--MarginTop":0}}))},{component:h.A.PLAIN_TEXT,name:"update-details",label:T({reviewObject:S,key:"update-details"})},{component:h.A.PLAIN_TEXT,name:"package-details",label:T({reviewObject:U,key:"package-details"})},{component:h.A.PLAIN_TEXT,name:"warning-text",label:a().createElement(i.TextContent,{className:"pf-u-pt-md"},a().createElement(i.Text,{style:{color:"var(--pf-global--warning-color--200"},component:"small"},a().createElement(d(),{style:{color:"var(--pf-global--warning-color--100"}})," ","After the update is installed, the system will apply the changes."))}]};return a().createElement(a().Fragment,null,m?a().createElement(g.A,{size:"medium",title:`Update system${j?"s":""} to latest image version`,isOpen:t.isOpen,closeModal:()=>n((e=>({...e,isOpen:!1}))),submitLabel:"Update system",schema:L,onSubmit:async()=>{try{await(0,I.A)(A,(()=>(0,v.Pn)({DevicesUUID:O})),M,p)}catch(e){A({...(0,b.z8)({variant:"danger",title:"Updating a system was unsuccessful",description:`Response: ${e.statusText}`})})}n((e=>({...e,isOpen:!1}))),c&&c()},reloadData:c,notificationProp:p}):a().createElement(s.Backdrop,null,a().createElement(o.Bullseye,null,a().createElement(l.Spinner,{diameter:"100px"}))))};O.propTypes={refreshTable:m().func,inventoryGroupUpdateDevicesInfo:m().shape({group_uuid:m().string,update_valid:m().bool,image_set_id:m().number,update_devices_uuids:m().array}),updateModal:m().shape({isOpen:m().bool.isRequired,deviceData:m().array.isRequired,imageData:m().object,imageId:m().number,imageSetId:m().number}).isRequired,setUpdateModal:m().func.isRequired,notificationProp:m().object};const j=O},59409:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(93345),a=n.n(r),i=n(48263),o=n(97744),s=n(63537),l=n(24408),u=n(5556),c=n.n(u);const d=({isOpen:e,title:t,titleIconVariant:n,closeModal:r,submitLabel:u,schema:c,initialValues:d,variant:p,reloadData:m,size:f,onSubmit:v,additionalMappers:y,validatorMapper:b})=>a().createElement(i.Modal,{variant:f??"small",title:t,titleIconVariant:n??null,isOpen:e,onClose:r},a().createElement(o.A,{schema:c,validatorMapper:b,FormTemplate:e=>a().createElement(s.Ay,{...e,submitLabel:u,disableSubmit:["invalid"],buttonsProps:{submit:{variant:p}}}),initialValues:d,componentMapper:y?{...y,...l.Ay}:l.Ay,onSubmit:async e=>{await v(e),setTimeout((async()=>await m()),500),r()},onCancel:()=>r()}));d.propTypes={isOpen:c().bool,title:c().string,closeModal:c().func,reloadData:c().func,submitLabel:c().string,schema:c().object,initialValues:c().object,variant:c().string,onSubmit:c().func,size:c().string,additionalMappers:c().object,titleIconVariant:c().any,validatorMapper:c().object};const p=d},25823:()=>{},16369:()=>{},62275:()=>{},89205:()=>{},20681:()=>{},43145:(e,t,n)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{A:()=>r})},9417:(e,t,n)=>{"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{A:()=>r})},92901:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(20816);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,r.A)(a.key),a)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},73893:(e,t,n)=>{"use strict";function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{A:()=>r})},60436:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(43145),a=n(73893),i=n(27800);function o(e){return function(e){if(Array.isArray(e))return(0,r.A)(e)}(e)||(0,a.A)(e)||(0,i.A)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},27800:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(43145);function a(e,t){if(e){if("string"==typeof e)return(0,r.A)(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.A)(e,t):void 0}}}}]);